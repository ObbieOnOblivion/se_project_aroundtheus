!function(){"use strict";class e{constructor(e,t){this._options=e,this._formElement=t}_checkFormValidity(e){return e.every((e=>e.validity.valid))}disableButton(){const e=this._options.inactiveButtonClass,t=this._formElement.querySelector(this._options.submitButtonSelector);t.classList.add(e),t.disabled=!0}activateButton(){const e=this._options.inactiveButtonClass,t=this._formElement.querySelector(this._options.submitButtonSelector);t.classList.remove(e),t.disabled=!1}_toggleButtonState(){this._checkFormValidity(this._inputElements)?this.activateButton():this.disableButton()}_showInputError(e){const{inputErrorClass:t,errorClass:s}=this._options,n=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(t),n.textContent=e.validationMessage,n.classList.add(s)}_hideInputError(e){const{inputErrorClass:t,errorClass:s}=this._options,n=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(t),n.textContent="",n.classList.remove(s)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){const{inputSelector:e}=this._options,t=[...this._formElement.querySelectorAll(e)];this._inputElements=t,t.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(t)}))}))}enableValidation(){this._setEventListeners()}}class t{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._container=t,this._renderer=n}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_open"),document.removeEventListener("keydown",this._handleEscapeClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal")&&this.close()})),this._popupElement.querySelector(".modal__close-button").addEventListener("click",(()=>{this.close()}))}}class n extends s{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._form=document.querySelector(e).querySelector("form"),this._inputList=[...this._popupElement.querySelectorAll("input")]}setPreviewedValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupElement.querySelector(".modal__save-button").textContent="Saving..."}))}}var r=class{constructor(e,t,s,n,r,o){this._name=e,this._link=t,this._template=s,this._imageClickHandler=n,this._deleteHandler=r,this._toggleButton=o}_addImageFunctionality(){this._template.querySelector("#gallery__image").addEventListener("click",(()=>{this._imageClickHandler({name:this._name,link:this._link})}))}_addLikeFunctionality(){const e=this._template.querySelector("#gallery__like-button");e.addEventListener("click",(()=>{e.classList.toggle("gallery__like-button_liked"),this._toggleButton(this._name,this._link)}))}_addDeleteFunctionality(){const e=this._template.querySelector("#gallery__trash");e.addEventListener("click",(()=>{this._deleteHandler((()=>{const t=e.closest(".gallery__card");t&&t.remove()}),this._name,this._link)}))}_setEventListeners(){this._addImageFunctionality(),this._addLikeFunctionality(),this._addDeleteFunctionality()}addCard(){this._template=this._template.cloneNode(!0);const e=this._template,t=e.querySelector("#gallery__image");return e.querySelector("#gallery__text").textContent=this._name,t.src=this._link,t.alt=this._name,this._setEventListeners(),this._template}};class o extends s{constructor(e){super({popupSelector:e})}open(e){let{name:t,link:s}=e;super.open(),this._popupElement.querySelector(".modal__picture").src=s,this._popupElement.querySelector("img").alt=t,this._popupElement.querySelector("h4").textContent=t}}class i{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this.headers=s}changeAvatar(e){fetch("https://around-api.en.tripleten-services.com/v1/users/me/avatar",{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{console.log("Avatar updated successfully:",e)})).catch((e=>{console.error("Error updating avatar:",e)}))}toggleButtonState(e,t){const s=`https://around-api.en.tripleten-services.com/v1/cards/${e}/likes`;console.log("thisisis");const n={method:t?"DELETE":"PUT",headers:this.headers};return fetch(s,n).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>(console.log("Card like status updated successfully:",e),e))).catch((e=>{throw console.error("Error updating card like status:",e),e}))}deleteCard(e){const t=`${this.baseUrl}/cards/${e}`,s={method:"DELETE",headers:this.headers};return fetch(t,s).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);console.log("Resource deleted successfully")})).catch((e=>{throw console.error("Error:",e),e}))}getCardInfo(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=`${this.baseUrl}/cards`,o={method:"GET",headers:this.headers};return fetch(r,o).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((r=>{const o=[...r].reverse().findIndex((s=>s.name===e&&s.link===t));if(-1!==o){const e=r[r.length-1-o];console.log("Last instance found:",e),s&&this.deleteCard(e._id),console.log(e.isLiked),n&&this.toggleButtonState(e._id,e.isLiked)}else console.log("No instance found with the specified name and link.")})).catch((e=>{throw console.error("Error:",e),e}))}addCardInfo(e,t,s){const n=`${this.baseUrl}/cards`,r={method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})};fetch(n,r).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{s(e.name,e.link)})).catch((e=>{console.error("Error:",e)}))}setUserInfo(e,t){const s=`${this.baseUrl}/users/me`,n={name:e,about:t},r={method:"PATCH",headers:this.headers,body:JSON.stringify(n)};return fetch(s,r).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>e)).catch((e=>{}))}}class a{constructor(e,t){this._nameElement=e,this._aboutMeElement=t}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutMeElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._aboutMeElement.textContent=s}}class l extends s{constructor(e,t,s){super({popupSelector:e}),this.submitHandler=t,this.apiDelete=s}open(){super.open()}setEventListeners(){document.querySelector(".modal-confirm__save-button").addEventListener("click",(e=>{this.submitHandler(),this.apiDelete(),super.close()}))}}class c extends s{constructor(e,t){super({popupSelector:e}),this.submitHandler=t}open(){super.open()}setEventListeners(){this._popupElement.querySelector("form").addEventListener("submit",(e=>{e.preventDefault();const t=this._popupElement.querySelector(".modal-avatar__input").value;this.submitHandler(t),super.close()}))}}!function(){const s=new i({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9b29ae94-bb6f-470b-bccd-5f1bdf13a16a","Content-Type":"application/json"}}),u=new c(".modal-avatar",(function(e){d.src=e,s.changeAvatar(e)})),d=document.querySelector(".profile__avatar");function h(e,t){s.getCardInfo(e,t,!1,!0)}function p(e,t,n){const r=new l("#confirmation-modal",e,(()=>{s.getCardInfo(t,n,!0)}));r.open(),r.setEventListeners()}d.addEventListener("click",(()=>{u.open(),u.setEventListeners()}));const m=e=>{let{name:t,link:s}=e;T.open({name:t,link:s})},_=document.querySelector("#card-template").content.firstElementChild,E=document.querySelector("#gallery__list"),f=new t({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{x(e.name,e.link,_)}},E);f.renderItems();const v=document.forms["edit-form"],g=document.forms["add-form"],y={formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"transparent",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},S=new e(y,v),k=new e(y,g);S.enableValidation(),k.enableValidation();const b=document.querySelector("#profile"),L=b.querySelector("#profile__edit_button"),w=b.querySelector("#profile__add_button"),C=b.querySelector("#profile__name"),q=b.querySelector("#profile__description"),I=new a(C,q),T=new o("#picture-modal"),B=new n(`#${v.parentElement.id}`,(function(e){B.close(),s.setUserInfo(e.name,e.description).then((e=>{I.setUserInfo({name:e.name,about:e.about})}))})),j=new n(`#${g.parentElement.id}`,(function(e){let{name:t,description:s}=e;x(t,s,_),j.close()}));function x(e,t,n){s.addCardInfo(e,t,(function(e,t){const s=new r(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:m,p,h);f.addItem(s.addCard())}))}T.setEventListeners(),L.addEventListener("click",(()=>{B.setPreviewedValues({name:C.innerText,description:q.innerText}),B.open()})),w.addEventListener("click",(()=>{j.open(),k.disableButton()})),B.setEventListeners(),j.setEventListeners()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S3pILEVBQU0wRSxFQUgxQlYsVUFBQUMsT0FBQSxRQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBR3pELEVBQ0h5RCxVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHeEQsRUFFc0RxRixFQUFxQkQsR0FDckZRLEVBQWE5SCxRQUFRa0osRUFBVTlGLFVBQ2pDLEdBR0YsQ0FoQkFxRSxFQUFXNUcsb0JBbUNYNEgsRUFBa0JySixpQkFBaUIsU0FBUyxLQUMxQ3lKLEVBQVV2SCxtQkFBbUIsQ0FDM0JJLEtBQU1pSCxFQUFZUyxVQUNsQmhELFlBQWF3QyxFQUFtQlEsWUFFbENQLEVBQVV2SSxNQUFNLElBR2xCb0ksRUFBaUJ0SixpQkFBaUIsU0FBUyxLQUN6QzRKLEVBQVMxSSxPQUNUaUksRUFBYTlLLGVBQWUsSUFHOUJvTCxFQUFVaEksb0JBRVZtSSxFQUFTbkksbUJBQ1YsQ0EvS0QsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL2NvbmZpcm1hdGlvblBvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0F2YXRhclBvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX2NoZWNrRm9ybVZhbGlkaXR5KGVsZW1lbnRzKSB7XG4gICAgcmV0dXJuIGVsZW1lbnRzLmV2ZXJ5KChlbGVtZW50KSA9PiBlbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgY29uc3QgaW5hY3RpdmVCdXR0b25DbGFzcyA9IHRoaXMuX29wdGlvbnMuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICBjb25zdCBzYXZlQnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX29wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIHNhdmVCdXR0b24uY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICBzYXZlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGFjdGl2YXRlQnV0dG9uKCkge1xuICAgIGNvbnN0IGluYWN0aXZlQnV0dG9uQ2xhc3MgPSB0aGlzLl9vcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9vcHRpb25zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgICBzYXZlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgc2F2ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGlzRm9ybVZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkodGhpcy5faW5wdXRFbGVtZW50cyk7XG5cbiAgICBpZiAoIWlzRm9ybVZhbGlkKSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hY3RpdmF0ZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fb3B0aW9ucztcbiAgICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTXNnRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1zZ0VsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fb3B0aW9ucztcbiAgICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTXNnRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNc2dFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgY29uc3QgaW5wdXRFbGVtZW50cyA9IFtcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gaW5wdXRFbGVtZW50cztcblxuICAgIGlucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0RWxlbWVudHMpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgRm9ybVZhbGlkYXRvciB9O1xuIiwiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG5cbmV4cG9ydCB7IFNlY3Rpb24gfTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5cIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGNsb3NlQnRuID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKS5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKV07XG4gIH1cblxuICBzZXRQcmV2aWV3ZWRWYWx1ZXModmFsdWVzKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlc1tpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICBjb25zdCBzYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgeyBQb3B1cFdpdGhGb3JtIH07XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IobmFtZSwgbGluaywgdGVtcGxhdGUsIGltYWdlQ2xpY2tIYW5kbGVyLCBkZWxldGVIYW5kbGVyLCB0b2dnbGVCdXR0b24pIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgIHRoaXMuX2ltYWdlQ2xpY2tIYW5kbGVyID0gaW1hZ2VDbGlja0hhbmRsZXI7XG4gICAgdGhpcy5fZGVsZXRlSGFuZGxlciA9IGRlbGV0ZUhhbmRsZXI7IFxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbiA9IHRvZ2dsZUJ1dHRvbjsgXG4gIH1cblxuICBfYWRkSW1hZ2VGdW5jdGlvbmFsaXR5KCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gdGhpcy5fdGVtcGxhdGU7XG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2dhbGxlcnlfX2ltYWdlXCIpO1xuXG4gICAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2ltYWdlQ2xpY2tIYW5kbGVyKHtcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgICAgbGluazogdGhpcy5fbGluayxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cblxuICBfYWRkTGlrZUZ1bmN0aW9uYWxpdHkoKSB7IFxuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl90ZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiI2dhbGxlcnlfX2xpa2UtYnV0dG9uXCIpO1xuICAgIFxuICAgIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblxuICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiZ2FsbGVyeV9fbGlrZS1idXR0b25fbGlrZWRcIik7IC8vcGFzcyB0aGlzIHRvIHRoZSBpc0xpa2UgaW4gQXBpIGNsYXNzIFxuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuXG4gICAgfSk7XG4gIH1cblxuICBfYWRkRGVsZXRlRnVuY3Rpb25hbGl0eSgpIHtcbiAgICBjb25zdCBkZWxldGVCdXR0b24gPSB0aGlzLl90ZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiI2dhbGxlcnlfX3RyYXNoXCIpO1xuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgY29uc3QgcHJlZm9ybURlbGV0ZUFjdGlvbiA9ICgpID0+e1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRlbGV0ZUJ1dHRvbi5jbG9zZXN0KFwiLmdhbGxlcnlfX2NhcmRcIik7XG4gICAgICAgIGlmIChjYXJkRWxlbWVudCkge1xuICAgICAgICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLl9kZWxldGVIYW5kbGVyKHByZWZvcm1EZWxldGVBY3Rpb24sIHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXG5cblxuICAgIH0pO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2FkZEltYWdlRnVuY3Rpb25hbGl0eSgpO1xuXG4gICAgdGhpcy5fYWRkTGlrZUZ1bmN0aW9uYWxpdHkoKTtcblxuICAgIHRoaXMuX2FkZERlbGV0ZUZ1bmN0aW9uYWxpdHkoKTtcbiAgfVxuXG4gIGFkZENhcmQoKSB7XG4gICAgdGhpcy5fdGVtcGxhdGUgPSB0aGlzLl90ZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlO1xuICAgIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNnYWxsZXJ5X19pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkVGl0bGVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZ2FsbGVyeV9fdGV4dFwiKTtcblxuICAgIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIGNhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl90ZW1wbGF0ZTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICB9XG5cbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcGljdHVyZVwiKS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoNFwiKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gIH1cbn1cblxuZXhwb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgY2hhbmdlQXZhdGFyKGxpbmspIHtcblxuICAgIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWUvYXZhdGFyXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIFN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkF2YXRhciB1cGRhdGVkIHN1Y2Nlc3NmdWxseTpcIiwgZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnJvcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGNhcmRJZCwgaXNMaWtlZCkge1xuICAgIGNvbnN0IGFwaVVybCA9IGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgO1xuICAgIGNvbnNvbGUubG9nKFwidGhpc2lzaXNcIik7XG5cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH07XG5cbiAgICByZXR1cm4gZmV0Y2goYXBpVXJsLCByZXF1ZXN0T3B0aW9ucylcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJDYXJkIGxpa2Ugc3RhdHVzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5OlwiLCBkYXRhKTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgY2FyZCBsaWtlIHN0YXR1czpcIiwgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChyZXNvdXJjZSkge1xuICAgIGNvbnN0IGFwaVVybCA9IGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtyZXNvdXJjZX1gO1xuXG4gICAgY29uc3QgcmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfTtcblxuICAgIHJldHVybiBmZXRjaChhcGlVcmwsIHJlcXVlc3RPcHRpb25zKVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIFN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJSZXNvdXJjZSBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0Q2FyZEluZm8obmFtZVRvRmluZCwgbGlua1RvRmluZCwgYXBpRGVsZXRlID0gZmFsc2UsIHRvZ2dsZUJ1dHRvbiA9IGZhbHNlKSB7XG4gICAgY29uc3QgYXBpVXJsID0gYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2A7XG5cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGZldGNoKGFwaVVybCwgcmVxdWVzdE9wdGlvbnMpXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIGNvbnN0IHJldmVyc2VkRGF0YSA9IFsuLi5kYXRhXS5yZXZlcnNlKCk7XG4gICAgICAgIGNvbnN0IGxhc3RJbmRleCA9IHJldmVyc2VkRGF0YS5maW5kSW5kZXgoXG4gICAgICAgICAgKHVzZXIpID0+IHVzZXIubmFtZSA9PT0gbmFtZVRvRmluZCAmJiB1c2VyLmxpbmsgPT09IGxpbmtUb0ZpbmRcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAobGFzdEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgIGNvbnN0IGxhc3RJbnN0YW5jZSA9IGRhdGFbZGF0YS5sZW5ndGggLSAxIC0gbGFzdEluZGV4XTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkxhc3QgaW5zdGFuY2UgZm91bmQ6XCIsIGxhc3RJbnN0YW5jZSk7XG4gICAgICAgICAgaWYgKGFwaURlbGV0ZSkge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVDYXJkKGxhc3RJbnN0YW5jZS5faWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zb2xlLmxvZyhsYXN0SW5zdGFuY2UuaXNMaWtlZCk7XG4gICAgICAgICAgaWYgKHRvZ2dsZUJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZShsYXN0SW5zdGFuY2UuX2lkLCBsYXN0SW5zdGFuY2UuaXNMaWtlZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gaW5zdGFuY2UgZm91bmQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUgYW5kIGxpbmsuXCIpO1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZEluZm8obmFtZSwgZGVzY3JpcHRpb24sIGFkZENhcmQpIHtcbiAgICAvLyBjaGFuZ2UgbmFtZSBvZiB4IGZ1bmN0aW9uXG4gICAgY29uc3QgYXBpVXJsID0gYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2A7XG4gICAgY29uc3QgcmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lOiBuYW1lLCBsaW5rOiBkZXNjcmlwdGlvbiB9KSxcbiAgICB9O1xuXG4gICAgZmV0Y2goYXBpVXJsLCByZXF1ZXN0T3B0aW9ucylcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgYWRkQ2FyZChkYXRhW1wibmFtZVwiXSwgZGF0YVtcImxpbmtcIl0pO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XG4gICAgY29uc3QgYXBpVXJsID0gYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWA7XG5cbiAgICBjb25zdCBwYXRjaERhdGEgPSB7XG4gICAgICBuYW1lOiBuYW1lLFxuICAgICAgYWJvdXQ6IGFib3V0LFxuICAgIH07XG5cbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF0Y2hEYXRhKSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGZldGNoKGFwaVVybCwgcmVxdWVzdE9wdGlvbnMpXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdVcGRhdGVkIHJlc291cmNlOicsIGRhdGEpO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCB7IEFwaSB9O1xuIiwiY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGFib3V0TWVTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gbmFtZVNlbGVjdG9yO1xuICAgIHRoaXMuX2Fib3V0TWVFbGVtZW50ID0gYWJvdXRNZVNlbGVjdG9yO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0TWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXRNZUVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxufVxuXG5leHBvcnQgeyBVc2VySW5mbyB9O1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmNsYXNzIGNvbmZpcm1hdGlvblBvcHVwIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyLCBhcGlEZWxldGUgKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XG4gICAgdGhpcy5hcGlEZWxldGUgPSBhcGlEZWxldGU7XG4gIH1cbiAgb3BlbigpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtY29uZmlybV9fc2F2ZS1idXR0b25cIik7XG4gICAgc2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuc3VibWl0SGFuZGxlcigpO1xuICAgICAgdGhpcy5hcGlEZWxldGUoKTtcbiAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IHsgY29uZmlybWF0aW9uUG9wdXAgfTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5jbGFzcyBhdmF0YXJQb3B1cCBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLnN1Ym1pdEhhbmRsZXIgPSBzdWJtaXRIYW5kbGVyO1xuICB9XG4gIG9wZW4oKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IHNhdmVGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJmb3JtXCIpO1xuICAgIHNhdmVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNvbnN0IGxpbmsgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1hdmF0YXJfX2lucHV0XCIpLnZhbHVlO1xuICAgICAgdGhpcy5zdWJtaXRIYW5kbGVyKGxpbmspO1xuICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgeyBhdmF0YXJQb3B1cCB9O1xuIiwiaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuaW1wb3J0IHsgY29uZmlybWF0aW9uUG9wdXAgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9jb25maXJtYXRpb25Qb3B1cFwiO1xuaW1wb3J0IHsgYXZhdGFyUG9wdXAgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BdmF0YXJQb3B1cFwiO1xuXG5cbihmdW5jdGlvbiBkaXNwbGF5Q2FyZHMoKSB7XG4gIGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICAgIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBhdXRob3JpemF0aW9uOiBcIjliMjlhZTk0LWJiNmYtNDcwYi1iY2NkLTVmMWJkZjEzYTE2YVwiLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgfSxcbiAgfSk7XG4gIFxuICBjb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgYXZhdGFyUG9wdXAoXCIubW9kYWwtYXZhdGFyXCIsIGNoYWdlQXZhdGFyKTsgLy8gdHJ5IHRvIGluY29ycG9yYXRlIFBvcHVwV2l0aEZvcm1cbiAgY29uc3QgYXZhdGFyUGhvdG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbiAgXG4gIGZ1bmN0aW9uIGNoYWdlQXZhdGFyKGlucHV0VmFsdWUpe1xuICAgIGF2YXRhclBob3RvLnNyYyA9IGlucHV0VmFsdWU7XG4gICAgYXBpLmNoYW5nZUF2YXRhcihpbnB1dFZhbHVlKTtcbiAgfVxuICBcbiAgYXZhdGFyUGhvdG8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+e1xuICAgIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XG4gICAgZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH0pXG4gIFxuICBcbiAgZnVuY3Rpb24gdG9nZ2xlTGlrZUJ1dHRvbihuYW1lLCBsaW5rKXsgXG4gICAgYXBpLmdldENhcmRJbmZvKG5hbWUsIGxpbmssIGZhbHNlICx0cnVlKVxuICB9XG4gIFxuICBmdW5jdGlvbiB0cmlnZ2VyQ29uZmlybWF0aW9uKGRlbGV0ZUNhcmQsIG5hbWUsIGxpbmspe1xuICAgIGNvbnN0IGFwaURlbGV0ZSA9ICgpID0+e1xuICAgICAgYXBpLmdldENhcmRJbmZvKG5hbWUsIGxpbmssIHRydWUpOyBcbiAgICB9XG4gICAgY29uc3QgY29uZmlybVBvcHVwID0gbmV3IGNvbmZpcm1hdGlvblBvcHVwKFwiI2NvbmZpcm1hdGlvbi1tb2RhbFwiLCBkZWxldGVDYXJkLCBhcGlEZWxldGUpO1xuICAgIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XG4gICAgY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIFxuICB9XG4gIFxuICAvLyBFbGVtZW50c1xuICBjb25zdCBpbWFnZUNsaWNrSGFuZGxlciA9ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICAgIGltYWdlUG9wdXAub3Blbih7IG5hbWUsIGxpbmsgfSk7XG4gIH07XG4gIGNvbnN0IGNhcmRUZW1wbGF0ZSA9XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gIGNvbnN0IGdhbGxlcnlMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNnYWxsZXJ5X19saXN0XCIpO1xuXG4gIGNvbnN0IGl0ZW1zID0gW1xuICAgIHtcbiAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgICB9LFxuXG4gICAge1xuICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICAgIH0sXG5cbiAgICB7XG4gICAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICAgIH0sXG5cbiAgICB7XG4gICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICAgIH0sXG4gIF07XG5cbiAgY29uc3QgY2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgaXRlbXMsXG4gICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgIGNyZWF0ZUNhcmQoY2FyZERhdGEubmFtZSwgY2FyZERhdGEubGluaywgY2FyZFRlbXBsYXRlKTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICBnYWxsZXJ5TGlzdFxuICApO1xuICBjYXJkc1NlY3Rpb24ucmVuZGVySXRlbXMoKTtcblxuICBjb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1mb3JtXCJdO1xuICBjb25zdCBhZGRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtZm9ybVwiXTtcblxuICBjb25zdCBjb25maWd1cmF0aW9uID0ge1xuICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lclwiLFxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInRyYW5zcGFyZW50XCIsXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gICAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxuICB9O1xuXG4gIGNvbnN0IGVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWd1cmF0aW9uLCBlZGl0Rm9ybSk7XG4gIGNvbnN0IGFkZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ3VyYXRpb24sIGFkZEZvcm0pO1xuXG4gIGVkaXRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICBhZGRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4gIGNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVcIik7XG4gIGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2VkaXRfYnV0dG9uXCIpO1xuICBjb25zdCBwcm9maWxlQWRkQnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2FkZF9idXR0b25cIik7XG4gIGNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX25hbWVcIik7XG4gIGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbiAgY29uc3QgdXNlciA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uKTtcblxuICBjb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BpY3R1cmUtbW9kYWxcIik7XG5cbiAgY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gICAgYCMke2VkaXRGb3JtLnBhcmVudEVsZW1lbnQuaWR9YCxcbiAgICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuICApO1xuICBjb25zdCBhZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICAgIGAjJHthZGRGb3JtLnBhcmVudEVsZW1lbnQuaWR9YCxcbiAgICBoYW5kbGVQcm9maWxlQWRkU3VibWl0XG4gICk7XG5cbiAgaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gIC8vZnVuY3Rpb25zXG5cbiAgZnVuY3Rpb24gY3JlYXRlQ2FyZChuYW1lLCBkZXNjcmlwdGlvbiwgdGVtcGxhdGUpIHtcbiAgICBjb25zdCBjcmVhdGVDYXJkID0gKFxuICAgICAgbmFtZSxcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgb3B0aW9uMSA9IHRlbXBsYXRlLFxuICAgICAgb3B0aW9uMiA9IGltYWdlQ2xpY2tIYW5kbGVyXG4gICAgKSA9PiB7XG4gICAgICBjb25zdCBtb2RlbENhcmQgPSBuZXcgQ2FyZChuYW1lLCBkZXNjcmlwdGlvbiwgb3B0aW9uMSwgb3B0aW9uMiwgdHJpZ2dlckNvbmZpcm1hdGlvbiwgdG9nZ2xlTGlrZUJ1dHRvbik7IFxuICAgICAgY2FyZHNTZWN0aW9uLmFkZEl0ZW0obW9kZWxDYXJkLmFkZENhcmQoKSk7XG4gICAgfTtcblxuICAgIGFwaS5hZGRDYXJkSW5mbyhuYW1lLCBkZXNjcmlwdGlvbiwgY3JlYXRlQ2FyZCk7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChpbnB1dEVsZW1lbnRzKSB7XG4gICAgZWRpdFBvcHVwLmNsb3NlKCk7XG5cbiAgICBhcGlcbiAgICAgIC5zZXRVc2VySW5mbyhpbnB1dEVsZW1lbnRzLm5hbWUsIGlucHV0RWxlbWVudHMuZGVzY3JpcHRpb24pXG4gICAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgIHVzZXIuc2V0VXNlckluZm8oeyBuYW1lOiByZXN1bHQubmFtZSwgYWJvdXQ6IHJlc3VsdC5hYm91dCB9KTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUFkZFN1Ym1pdCh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcbiAgICBjcmVhdGVDYXJkKG5hbWUsIGRlc2NyaXB0aW9uLCBjYXJkVGVtcGxhdGUpO1xuICAgIGFkZFBvcHVwLmNsb3NlKCk7XG4gIH1cblxuICAvL2V2ZW50IGxpc3RlbmVyc1xuXG4gIHByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgZWRpdFBvcHVwLnNldFByZXZpZXdlZFZhbHVlcyh7XG4gICAgICBuYW1lOiBwcm9maWxlTmFtZS5pbm5lclRleHQsXG4gICAgICBkZXNjcmlwdGlvbjogcHJvZmlsZURlc2NyaXB0aW9uLmlubmVyVGV4dCxcbiAgICB9KTtcbiAgICBlZGl0UG9wdXAub3BlbigpO1xuICB9KTtcblxuICBwcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgYWRkUG9wdXAub3BlbigpO1xuICAgIGFkZFZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIH0pO1xuXG4gIGVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gIGFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG59KSgpO1xuXG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9vcHRpb25zIiwiX2Zvcm1FbGVtZW50IiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiZWxlbWVudHMiLCJldmVyeSIsImVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiZGlzYWJsZUJ1dHRvbiIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJzYXZlQnV0dG9uIiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGlzYWJsZWQiLCJhY3RpdmF0ZUJ1dHRvbiIsInJlbW92ZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dEVsZW1lbnRzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImVycm9yTXNnRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJpbnB1dFNlbGVjdG9yIiwiaW5wdXRFbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJTZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfY29udGFpbmVyIiwiX3JlbmRlcmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiZG9jdW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0TGlzdCIsInNldFByZXZpZXdlZFZhbHVlcyIsInZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJuYW1lIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJyZXNldCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImxpbmsiLCJ0ZW1wbGF0ZSIsImltYWdlQ2xpY2tIYW5kbGVyIiwiZGVsZXRlSGFuZGxlciIsInRvZ2dsZUJ1dHRvbiIsIl9uYW1lIiwiX2xpbmsiLCJfdGVtcGxhdGUiLCJfaW1hZ2VDbGlja0hhbmRsZXIiLCJfZGVsZXRlSGFuZGxlciIsIl90b2dnbGVCdXR0b24iLCJfYWRkSW1hZ2VGdW5jdGlvbmFsaXR5IiwiX2FkZExpa2VGdW5jdGlvbmFsaXR5IiwibGlrZUJ1dHRvbiIsInRvZ2dsZSIsIl9hZGREZWxldGVGdW5jdGlvbmFsaXR5IiwiZGVsZXRlQnV0dG9uIiwicHJlZm9ybURlbGV0ZUFjdGlvbiIsImNhcmRFbGVtZW50IiwiY2xvc2VzdCIsImFkZENhcmQiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2VFbCIsInNyYyIsImFsdCIsIlBvcHVwV2l0aEltYWdlIiwiQXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJjaGFuZ2VBdmF0YXIiLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXZhdGFyIiwidGhlbiIsInJlc3BvbnNlIiwib2siLCJFcnJvciIsInN0YXR1cyIsImpzb24iLCJkYXRhIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyb3IiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImNhcmRJZCIsImlzTGlrZWQiLCJhcGlVcmwiLCJyZXF1ZXN0T3B0aW9ucyIsImRlbGV0ZUNhcmQiLCJyZXNvdXJjZSIsImdldENhcmRJbmZvIiwibmFtZVRvRmluZCIsImxpbmtUb0ZpbmQiLCJhcGlEZWxldGUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJsYXN0SW5kZXgiLCJyZXZlcnNlIiwiZmluZEluZGV4IiwidXNlciIsImxhc3RJbnN0YW5jZSIsIl9pZCIsImFkZENhcmRJbmZvIiwiZGVzY3JpcHRpb24iLCJzZXRVc2VySW5mbyIsImFib3V0IiwicGF0Y2hEYXRhIiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJhYm91dE1lU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfYWJvdXRNZUVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImNvbmZpcm1hdGlvblBvcHVwIiwic3VibWl0SGFuZGxlciIsImF2YXRhclBvcHVwIiwiYXBpIiwiYXV0aG9yaXphdGlvbiIsImVkaXRBdmF0YXJQb3B1cCIsImlucHV0VmFsdWUiLCJhdmF0YXJQaG90byIsInRvZ2dsZUxpa2VCdXR0b24iLCJ0cmlnZ2VyQ29uZmlybWF0aW9uIiwiY29uZmlybVBvcHVwIiwiaW1hZ2VQb3B1cCIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImdhbGxlcnlMaXN0IiwiY2FyZHNTZWN0aW9uIiwiY2FyZERhdGEiLCJjcmVhdGVDYXJkIiwiZWRpdEZvcm0iLCJmb3JtcyIsImFkZEZvcm0iLCJjb25maWd1cmF0aW9uIiwiZm9ybVNlbGVjdG9yIiwiZWRpdFZhbGlkYXRvciIsImFkZFZhbGlkYXRvciIsInByb2ZpbGUiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImVkaXRQb3B1cCIsInBhcmVudEVsZW1lbnQiLCJyZXN1bHQiLCJhZGRQb3B1cCIsIl9yZWYyIiwibW9kZWxDYXJkIiwiQ2FyZCIsImlubmVyVGV4dCJdLCJzb3VyY2VSb290IjoiIn0=